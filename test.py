import matplotlib.pyplot as plt
import numpy as np

from Lib import *

def main():

    HUB = np.array([[168.6535, 148.6855534],
                    [159.8596, 149.946652],
                    [151.026255162, 150.990708347],
                    [140.188130457, 151.969620772],
                    [128.576048, 152.65189],
                    [117.350547, 152.9529],
                    [107.451478, 152.926836],
                    [96.57558, 152.582908947],
                    [85.23569, 151.8718365],
                    [72.32411, 150.343797],
                    [60.8447531, 147.27592367],
                    [51.118600423, 143.1609922],
                    [41.3011847, 137.322919568],
                    [33.2328391685, 130.915966279],
                    [23.483434, 120.7346469],
                    [16.1653918554, 110.7538179],
                    [10.177407, 100.070102648],
                    [5.41542819070, 88.4188473],
                    [2.86329125445, 79.5453849],
                    [0.100130, 56.71522158],
                    [0, 50.05367],
                    [0, 25.4655147],
                    [0,0]])
    SHROUD = np.array([[168.653505528, 118.685553415],
                       [158.074389, 121.185725],
                       [146.8253591, 122.8041419],
                       [136.692392704, 123.226988512],
                       [125.611201, 122.607474237],
                       [116.44992841, 121.211366024],
                       [106.6143924, 118.726798021],
                       [99.2678820833, 115.847069823],
                       [91.7707416798, 111.080857122],
                       [83.8836379954, 103.262817639],
                       [77.5530585840, 93.2557817882],
                       [74.6518572010, 82.9243429092],
                       [74.23461457, 74.7169201658],
                       [74.6182787129, 66.5960795952],
                       [77.2826455601, 55.3840620754],
                       [80.9642280523, 47.2399385451],
                       [85.1739418715, 38.5975016857],
                       [89.0678283775, 30.6034503772],
                       [93.3244684978, 21.8646749991],
                       [98.0872227654, 12.0868599736],
                       [103.974708238, 0]])
    tck = Spline.find_tck(HUB)
    s1 = Spline(tck)
    tck = Spline.find_tck(SHROUD)
    s2 = Spline(tck)

    num = 50
    am = 1
    qs = np.linspace(0,1,num)
    midpts = np.empty(0)
    for i in qs:
        p1 = s1.eval(i)
        p2 = s2.eval(i)
        l1 = Line.line2Pts(p1, p2)
        p0 = l1.eval(0.5)
        midpts = np.append(midpts, p0)
    midpts = np.reshape(midpts, (num,2))
    plt.plot(midpts[:,0], midpts[:,1],'+')

    ps = np.empty(0)
    for i in qs:
        ps = np.append(ps, eqAreaSolver(s1,s2,i,am))
    ps = np.reshape(ps, (num,2))
    plt.plot(ps[:,0],ps[:,1],'o')
    # q1 = 0.5
    # p1 = s1.eval(q1)
    # p2 = s2.eval(q1)
    # l1 = Line.line2Pts(p1,p2)
    #
    # p3 = l1.eval(0.5)
    #
    # l2 = createPerp(s1, p3)
    # l3 = createPerp(s2, p3)
    #
    #
    #
    # l3.pltDraw(100)
    # l2.pltDraw(100)
    # plt.plot(p3[0],p3[1], 'o')
    # l1.pltDraw(100)
    s2.pltDraw()
    s1.pltDraw()

    plt.xlim(-1,175)
    plt.ylim(0, 160)
    plt.show()

if __name__ == "__main__":
    main()